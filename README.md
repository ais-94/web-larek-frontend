# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```sh
npm install
npm run start
npm install --save-dev @types/lodash
```
или

```sh
yarn
yarn start
```

## Сборка

```sh
npm run build
```

или

```sh
yarn build
```

## Проектирование архитектуры веб-приложения

** Код реализован на паттерне программирования MVP (Model-View-Presenter)

Модель (Model) - слой данных: изменяет данные и генерирует событие**

Представление (View) слой отображения, интерфейс для взаимодействия с пользователем, реагирует на действие пользователя и генерирует событие**

Презентер (Presenter) слушает события в пользовательском интерфейсе и принимает решение, извлекает данные из модели**

### Классы с группировкой по слоям.

### Базовый код:

Класс EventEmitter

Модель данных: Брокер событий

Методы:

`on` - Установить обработчик на событие

`off` - Снять обработчик с события

`emit` - Инициировать событие с данными

`onAll` - Слушать все события

`offAll` - Сбросить все обработчики

`trigger` - Сделать коллбек триггер, генерирующий событие при вызове

Класс `class Component<T>` -  класс для работы с DOM в дочерних компонентах

Методы:

`toggleClass` - переключить класс

`setText` - замениить текстовое содержимое

`setDisabled` - сменить статус блокировки

`setHidden` - Скрыть элемент

`setVisible` - Показать элемент

`setImage()` -Установить изображение с алтернативным текстом

`render` - Вернуть корневой DOM-элемент

Класс `Api` - 

`handleResponse` - обрабатывает и возвращает ответ сервера

`get(uri: string)` - принимает данные url, возвращает ответ

`post(uri: string, data: object, method: ApiPostMethods = 'POST')` - отправка данных на сервер

Класс `Model<T>`- класс, чтобы можно было отличить ее от простых объектов с данными

Методы: 

`emitChanges` -для сообщения, что модель поменялась


### Слой данных:

Класс `AppModel`

Методы

`setCards` - получаем массив объектов(карточек) с сервера.

`TotalPrice` - возвращает общую стоимость товаров в корзине

`addCardToBasket` - добавить карточку в корзину

`removeFromBasket` - удалить карточку из корзины

`clearBasket` - очистить корзину

`validationForm` - валидация инпутов

`setOrderPayment` - устанавливает вид оплаты

`getOrderData` - возвращает значения полей формы

`setContactData` - устанавливает адрес и телефон


Геттеры

`basket` -  отображение корзины

`products` - возвращает список карточек в корзине 

`order` - возвращает данные заказа


Класс `OrderForm`  - хранит данные полученные от пользователя.

Методы:

`validation` - валидация введенных данных


Геттеры:

`payment` - возвращает вид оплаты


`address` - возвращает адрес пользователя

Сеттеры:

`payment` - устанавливает вид оплаты


`address` - устанавливает адрес пользователя


### Слой представления:

Класс `Basket` - управляет отображением корзины

`renderBasket` - отображает список товаров и общую стоимость

Класс `Form` - компонет формы

Сеттеры:

`valid` - блокировка кнопки

`errors` - устанавливает вид ошибки

Методы:
`onInputChange` - устанавливает значения полей ввода

`render` - возвращает значения полей ввода


Класс `Page` - для управления отображением карточек, корзины
`renderCatalog` - вывести все карточки 

Сеттеры
`counter` - счетчик товаров в корзине

`locked` - блокировка прокрутки страницы при открытом модальном окне


Класс `Modal` - управляет отображением модальных окон.

Методы:

`open()` - открыть окно.

`close()` - закрыть окно.

`handleEscUp` - закрыть окно нажатем Esc


Класс `Card` - отвечает за отображение карточки товара, корзины.

Сеттеры:

`category` - устанавливает категорию карточки товара

`price` - установка стоимости или отсутсвие цены

`title` - установка данных карточки 

`image` - кстановка изображения карточки 


Класс `BasketCards` - работа с данными корзины

`renderCard` - отображает список товаров и общую стоимость

Сеттеры:

`index` - нумерация товаров в корзине

`title` - нименование товаров

`price` - стоимость товаров в корзине


Класс `CardInfoView` - для отображения информации отдельной карточки

методы

`renderCard` - отображает инфмацию о товаре

Сеттеры:

`text` - описание товара

`button` - изменение состаяния кнопки


Класс `ContactForm` управляет отображением содержимого модального окна и позволяет принять от пользователя номер телефона и Email.

Сеттеры:

`email` - устанавливает значение электронной почты

`phone` - устанавливает значение телефонного номера

Геттеры:

`email` - возвращает значение электронной почты

`phone` - возвращает значение телефонного номера


Класс `Success` - отображение успешного заказа в модальном окне

Сеттеры:

`total` - устанавливает суммарное значение стоимости товаров в модальном окне

### Слой презентера:

Класс WebApi - меторды взаимодействия с API сервером и остальными классами

`createOrder` - отправляет данные заказа на сервер

`getCardList` - возвразает массив карточек


Слой презентера реализован в файле index.ts 

События events.on:

`products:updated` - отображение всех карточек на странице

`card:select`  - выбор карточки

`modal:open` - открытие модального окна

`modal:close` - закрытие модального окна

`basket:open` - открыть корзину

`basket:close` - закрыть корзину

`basket:update` - изменение содержимого корзины

`card:remove` - удалить карточку из корзины